<div class="admin-dashboard-container">
  <!-- Header Section (Profile at Top - Full Width) -->
  <div class="header-section">
    <button class="mobile-menu-icon" aria-label="Open menu" (click)="toggleMobileMenu()">
      <span class="bar"></span>
      <span class="bar"></span>
      <span class="bar"></span>
    </button>
    <div class="profile-header">
      <div class="profile-avatar">
        <mat-icon class="avatar-icon">admin_panel_settings</mat-icon>
      </div>
      <div class="profile-info">
        <h1 class="profile-name">Admin</h1>
      </div>
      <div class="header-actions">
        <app-notification-bell [userRole]="'ADMIN'"></app-notification-bell>
      </div>
    </div>
  </div>

  <div class="dashboard-body">
    <aside class="sidebar" [class.mobile-open]="mobileMenuOpen">
      <nav class="sidebar-nav">
        <button 
          class="nav-item" 
          [class.active]="currentView === 'dashboard'"
          (click)="showDashboard()">
          <mat-icon>dashboard</mat-icon>
          <span>Dashboard</span>
        </button>
        <button 
          class="nav-item" 
          [class.active]="currentView === 'contributions'"
          (click)="showContributions()">
          <mat-icon>payments</mat-icon>
          <span>Contributions</span>
        </button>
        <button 
          class="nav-item" 
          [class.active]="currentView === 'ngos'"
          (click)="showNgos()">
          <mat-icon>business</mat-icon>
          <span>NGOs</span>
        </button>
        <button 
          class="nav-item" 
          [class.active]="currentView === 'email-templates'"
          (click)="showEmailTemplates()">
          <mat-icon>email</mat-icon>
          <span>Email Templates</span>
        </button>
        <button 
          class="nav-item"
          [class.active]="currentView === 'leaderboard'"
          (click)="showLeaderboard()">
          <mat-icon>emoji_events</mat-icon>
          <span>Leaderboard</span>
        </button>
        <button 
          class="nav-item"
          [class.active]="currentView === 'sliders'"
          (click)="showSliders()">
          <mat-icon>slideshow</mat-icon>
          <span>Slider Management</span>
        </button>
        <button 
          class="nav-item logout-item"
          (click)="logout()">
          <mat-icon>logout</mat-icon>
          <span>Logout</span>
        </button>
      </nav>
    </aside>
    <div class="sidebar-backdrop" (click)="toggleMobileMenu()" [class.mobile-open]="mobileMenuOpen"></div>
    <main class="main-content">
    <div *ngIf="isLoading" class="loading-container">
      <mat-spinner diameter="50"></mat-spinner>
      <p>Loading...</p>
  </div>
    <div *ngIf="!isLoading && currentView === 'dashboard'" class="dashboard-view">
      <section class="hero-section">
        <div class="hero-content">
          <h1 class="hero-title">Admin Dashboard</h1>
          <p class="hero-subtitle">Platform analytics and insights</p>
        </div>
      </section>
      <section class="stats-section">
        <div class="stats-grid">
          <mat-card class="stat-card">
            <div class="stat-content">
              <div class="stat-icon-wrapper stat-primary">
                <mat-icon>volunteer_activism</mat-icon>
              </div>
              <div>
                <div class="stat-label">Total Contributions</div>
                <div class="stat-value">{{ analytics?.donations?.totalContributions || 0 }}</div>
                <div class="stat-sublabel">Total Funds: ₹{{ (analytics?.donations?.totalFunds || 0).toLocaleString('en-IN', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) }}</div>
              </div>
            </div>
          </mat-card>
          <mat-card class="stat-card">
            <div class="stat-content">
              <div class="stat-icon-wrapper stat-success">
                <mat-icon>business</mat-icon>
              </div>
              <div>
                <div class="stat-label">Total NGOs</div>
                <div class="stat-value">{{ analytics?.ngos?.total || 0 }}</div>
                <div class="stat-sublabel">Active: {{ analytics?.ngos?.active || 0 }}</div>
              </div>
            </div>
          </mat-card>
          <mat-card class="stat-card">
            <div class="stat-content">
              <div class="stat-icon-wrapper stat-info">
                <mat-icon>people</mat-icon>
              </div>
              <div>
                <div class="stat-label">Total Donors</div>
                <div class="stat-value">{{ analytics?.donors?.total || 0 }}</div>
                <div class="stat-sublabel">Active: {{ analytics?.donors?.active || 0 }}</div>
              </div>
            </div>
          </mat-card>
          <mat-card class="stat-card">
            <div class="stat-content">
              <div class="stat-icon-wrapper stat-accent">
                <mat-icon>verified</mat-icon>
              </div>
              <div>
                <div class="stat-label">Verified NGOs</div>
                <div class="stat-value">{{ analytics?.ngos?.verified || 0 }}</div>
                <div class="stat-sublabel">Pending: {{ analytics?.ngos?.pending || 0 }}</div>
              </div>
            </div>
          </mat-card>
        </div>
      </section>
      <section class="charts-section" *ngIf="getDonationBreakdownItems().length > 0 || getChartData().length > 0">
        <div class="charts-grid">
          <div class="chart-card donation-trends-card" *ngIf="getChartData().length > 0">
          <div class="chart-header">
            <div>
              <h3 class="chart-title">Donation Trends</h3>
              <p class="chart-subtitle">Monthly performance vs targets</p>
            </div>
            <div class="chart-toggle-buttons">
    <button 
                class="chart-toggle-btn" 
                [class.active]="chartViewMode === 'amount'"
                (click)="setChartViewMode('amount')">
                Amount
    </button>
    <button 
                class="chart-toggle-btn" 
                [class.active]="chartViewMode === 'donors'"
                (click)="setChartViewMode('donors')">
                Donors
    </button>
  </div>
          </div>
          <div class="bar-chart-container">
            <svg viewBox="0 0 600 280" style="width: 100%; height: 100%;">
              <!-- Y-axis -->
              <line x1="70" y1="20" x2="70" y2="220" stroke="#e2e8f0" stroke-width="1.5"/>
              
              <!-- X-axis -->
              <line x1="70" y1="220" x2="570" y2="220" stroke="#e2e8f0" stroke-width="1.5"/>
              
              <!-- Y-axis labels and horizontal grid lines -->
              <g *ngFor="let label of getYAxisLabels(); let i = index">
                <line x1="70" 
                      [attr.y1]="220 - (i * (200 / (getYAxisLabels().length - 1)))" 
                      x2="570" 
                      [attr.y2]="220 - (i * (200 / (getYAxisLabels().length - 1)))" 
                      stroke="#e2e8f0" 
                      stroke-width="1" 
                      stroke-dasharray="3,3"/>
                <!-- Y-axis label -->
                <text x="65" 
                      [attr.y]="225 - (i * (200 / (getYAxisLabels().length - 1)))" 
                      fill="#64748b" 
                      font-size="12" 
                      text-anchor="end" 
                      alignment-baseline="middle">{{ formatChartValue(label) }}</text>
              </g>
              <g *ngIf="getChartData().length > 0">
                <rect *ngFor="let value of getChartData(); let i = index; trackBy: trackByIndex"
                      [attr.x]="getBarXPosition(i)"
                      [attr.y]="getBarYPosition(value)"
                      [attr.width]="getBarWidth()"
                      [attr.height]="getBarHeight(value)"
                      fill="#10b981"/>
              </g>
              
              <!-- X-axis labels (Months) -->
              <text *ngFor="let label of getMonthlyTrendData().labels; let i = index"
                    [attr.x]="getBarXPosition(i) + (getBarWidth() / 2)"
                    y="240"
                    fill="#64748b"
                    font-size="12"
                    text-anchor="middle">{{ label }}</text>
            </svg>
          </div>
          </div>
          <mat-card class="chart-card" *ngIf="getDonationBreakdownItems().length > 0">
            <h3 class="chart-title">Donation Types Distribution</h3>
            <div class="donut-chart-container">
              <svg class="donut-chart" viewBox="0 0 200 200">
                <circle cx="100" cy="100" r="80" fill="none" stroke="#334155" stroke-width="40"/>
                <circle *ngFor="let item of getDonationBreakdownItems(); let i = index" 
                        [attr.cx]="100" [attr.cy]="100" r="80" 
                        fill="none" 
                        [attr.stroke]="['#10B981', '#3B82F6', '#FBBF24', '#8B5CF6', '#EF4444'][i % 5]"
                        stroke-width="40"
                        [attr.stroke-dasharray]="(item.count / getTotalDonations()) * 502.65 + ' 502.65'"
                        [attr.stroke-dashoffset]="getDonutOffset(i)"
                        transform="rotate(-90 100 100)"/>
              </svg>
              <div class="donut-chart-center">
                <span class="donut-center-value">{{ getTotalDonations() }}</span>
                <span class="donut-center-label">Total</span>
              </div>
            </div>
            <div class="chart-legend">
              <div class="legend-item" *ngFor="let item of getDonationBreakdownItems(); let i = index">
                <span class="legend-color" [style.background-color]="['#10B981', '#3B82F6', '#FBBF24', '#8B5CF6', '#EF4444'][i % 5]"></span>
                <span>{{ item.type }} ({{ item.count }})</span>
              </div>
            </div>
          </mat-card>
        </div>
      </section>
      <section class="summary-section">
        <h2 class="section-title">Funds Summary</h2>
        <div class="summary-grid">
          <mat-card class="summary-card">
            <div class="summary-content">
              <div class="summary-icon-wrapper summary-success">
                <mat-icon>account_balance_wallet</mat-icon>
              </div>
              <div class="summary-info">
                <div class="summary-label">Funds Received</div>
                <div class="summary-value">₹{{ (analytics?.donations?.fundsReceived || 0).toLocaleString('en-IN', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) }}</div>
              </div>
            </div>
          </mat-card>

          <mat-card class="summary-card">
            <div class="summary-content">
              <div class="summary-icon-wrapper summary-warning">
                <mat-icon>pending</mat-icon>
              </div>
              <div class="summary-info">
                <div class="summary-label">Funds Pending</div>
                <div class="summary-value">₹{{ (analytics?.donations?.fundsPending || 0).toLocaleString('en-IN', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) }}</div>
              </div>
            </div>
          </mat-card>
        </div>
      </section>
      <section class="summary-section">
        <h2 class="section-title">NGO Statistics</h2>
        <div class="summary-grid">
          <mat-card class="summary-card">
            <div class="summary-content">
              <div class="summary-icon-wrapper summary-primary">
                <mat-icon>check_circle</mat-icon>
              </div>
              <div class="summary-info">
                <div class="summary-label">Verified</div>
                <div class="summary-value">{{ analytics?.ngos?.verified || 0 }}</div>
              </div>
            </div>
          </mat-card>
          <mat-card class="summary-card">
            <div class="summary-content">
              <div class="summary-icon-wrapper summary-warning">
                <mat-icon>pending</mat-icon>
              </div>
              <div class="summary-info">
                <div class="summary-label">Pending</div>
                <div class="summary-value">{{ analytics?.ngos?.pending || 0 }}</div>
              </div>
            </div>
          </mat-card>
          <mat-card class="summary-card">
            <div class="summary-content">
              <div class="summary-icon-wrapper summary-danger">
                <mat-icon>block</mat-icon>
              </div>
              <div class="summary-info">
                <div class="summary-label">Blocked</div>
                <div class="summary-value">{{ analytics?.ngos?.blocked || 0 }}</div>
              </div>
            </div>
          </mat-card>
          <!-- <mat-card class="summary-card">
            <div class="summary-content">
              <div class="summary-icon-wrapper summary-success">
                <mat-icon>cancel</mat-icon>
              </div>
               <div class="summary-info">
                <div class="summary-label">Rejected</div>
                <div class="summary-value">{{ analytics?.ngos?.rejected || 0 }}</div>
              </div> 
            </div>
          </mat-card> -->
        </div>
      </section>
      <section class="customer-table-card" *ngIf="analytics?.ngos?.topNgos?.length > 0">
        <h2 class="section-title">Top NGOs by Contributions</h2>
        <table class="customer-table">
          <thead>
            <tr>
              <th>NGO Name</th>
              <th>Contributions</th>
              <th>Total Amount</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let ngo of analytics.ngos.topNgos">
              <td>
                <div style="display: flex; align-items: center; gap: 12px;">
                  <div class="customer-avatar">{{ ngo.name.charAt(0).toUpperCase() }}</div>
                  <div>
                    <div style="font-weight: 600; color: var(--text-primary);">{{ ngo.name }}</div>
                  </div>
                </div>
              </td>
              <td style="font-weight: 600; color: var(--text-primary);">{{ ngo.contributionCount }}</td>
              <td style="font-weight: 600; color: var(--primary-color);">{{ formatCurrency(ngo.totalAmount) }}</td>
            </tr>
          </tbody>
        </table>
      </section>
      <section class="customer-table-card" *ngIf="analytics?.donors?.topDonors?.length > 0">
        <h2 class="section-title">Top Donors</h2>
        <table class="customer-table">
          <thead>
            <tr>
              <th>Donor Name</th>
              <th>Contributions</th>
              <th>Total Amount</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let donor of analytics.donors.topDonors">
              <td>
                <div style="display: flex; align-items: center; gap: 12px;">
                  <div class="customer-avatar">{{ donor.name.charAt(0).toUpperCase() }}</div>
                  <div>
                    <div style="font-weight: 600; color: var(--text-primary);">{{ donor.name }}</div>
                    <div style="font-size: 12px; color: var(--text-secondary);">{{ donor.email }}</div>
                  </div>
                </div>
              </td>
              <td style="font-weight: 600; color: var(--text-primary);">{{ donor.contributionCount }}</td>
              <td style="font-weight: 600; color: var(--primary-color);">{{ formatCurrency(donor.totalAmount) }}</td>
            </tr>
          </tbody>
        </table>
      </section>
  </div>
    <div *ngIf="!isLoading && currentView === 'contributions'" class="dashboard-view">
      <section class="hero-section">
        <div class="hero-content">
          <h1 class="hero-title">Contributions Management</h1>
          <p class="hero-subtitle">View and manage all donor contributions across the platform</p>
        </div>
        <div class="hero-actions">
          <button mat-raised-button color="primary" (click)="downloadReport('csv')">
            <mat-icon>download</mat-icon>
            Download CSV
          </button>
          <button mat-raised-button color="primary" (click)="downloadReport('excel')">
            <mat-icon>download</mat-icon>
            Download Excel
          </button>
          <button mat-raised-button color="primary" (click)="downloadReport('pdf')">
            <mat-icon>picture_as_pdf</mat-icon>
            Download PDF
          </button>
        </div>
      </section>
      <section class="filters-section">
        <mat-card class="filters-card">
          <h3 class="filters-title">Filter Contributions</h3>
          <div class="filters-grid">
            <mat-form-field appearance="outline">
              <mat-label>Donor</mat-label>
              <select matNativeControl [(ngModel)]="filterDonorId" (change)="applyFilters()">
                <option value="">All Donors</option>
                <option *ngFor="let donor of donors" [value]="donor.donorId || donor.id">
                  {{ donor.name }}
                </option>
              </select>
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>NGO</mat-label>
              <select matNativeControl [(ngModel)]="filterNgoId" (change)="applyFilters()">
                <option value="">All NGOs</option>
                <option *ngFor="let ngo of allNgos" [value]="ngo.id">
                  {{ ngo.name }}
                </option>
              </select>
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>Donation Type</mat-label>
              <select matNativeControl [(ngModel)]="filterDonationType" (change)="applyFilters()">
                <option value="">All Types</option>
                <option value="FOOD">Food</option>
                <option value="CLOTHES">Clothes</option>
                <option value="FUNDS">Funds</option>
                <option value="MONEY">Money</option>
              </select>
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>From Date</mat-label>
              <input matInput type="date" [(ngModel)]="filterFromDate" (change)="applyFilters()">
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>To Date</mat-label>
              <input matInput type="date" [(ngModel)]="filterToDate" (change)="applyFilters()">
            </mat-form-field>

            <div class="filter-actions">
              <button mat-raised-button color="accent" (click)="clearFilters()">
                <mat-icon>clear</mat-icon>
                Clear Filters
              </button>
            </div>
          </div>
        </mat-card>
      </section>
  <div *ngIf="errorMessage" class="error-message">
    {{ errorMessage }}
  </div>
      <section class="contributions-section" *ngIf="!isLoadingContributions">
        <mat-card class="table-card">
          <div class="table-header">
            <h2 class="section-title">All Contributions</h2>
            <div class="table-stats">
              Total: {{ totalContributions }} contributions
            </div>
          </div>
          
          <div class="table-wrapper">
            <table class="contributions-table">
              <thead>
                <tr>
                  <th>Donor Name</th>
                  <th>Donor Email</th>
                  <th>NGO Name</th>
                  <th>Donation Type</th>
                  <th>Quantity/Amount</th>
                  <th>Contribution Date</th>
                  <th>Status</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let contribution of contributions">
                  <td>
                    <div class="donor-info">
                      <div class="donor-avatar">{{ (contribution.donorName || 'D')[0].toUpperCase() }}</div>
                      <span>{{ contribution.donorName || 'N/A' }}</span>
                    </div>
                  </td>
                  <td>{{ contribution.donorEmail || 'N/A' }}</td>
                  <td>{{ contribution.ngoName || 'N/A' }}</td>
                  <td>
                    <mat-chip [class]="'chip-' + (contribution.donationType || '').toLowerCase()">
                      {{ contribution.donationType || 'N/A' }}
                    </mat-chip>
                  </td>
                  <td>
                    <strong>{{ contribution.quantityOrAmount || 0 }}</strong>
                  </td>
                  <td>{{ formatDate(contribution.contributedDate) }}</td>
                  <td>
                    <span [class]="getStatusClass(contribution.contributionStatus)">
                      {{ contribution.contributionStatus || 'N/A' }}
                    </span>
                  </td>
                </tr>
                <tr *ngIf="contributions.length === 0">
                  <td colspan="7" class="no-data">
                    <div class="no-data-content">
                      <mat-icon>inbox</mat-icon>
                      <p>No contributions found</p>
                      <p class="no-data-subtitle">Try adjusting your filters</p>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="pagination" *ngIf="totalContributions > pageSize">
            <button mat-button [disabled]="currentPage === 1" (click)="onPageChange(currentPage - 1)">
              <mat-icon>chevron_left</mat-icon>
              Previous
            </button>
            <span class="page-info">
              Page {{ currentPage }} of {{ Math.ceil(totalContributions / pageSize) }}
            </span>
            <button mat-button [disabled]="currentPage >= Math.ceil(totalContributions / pageSize)" (click)="onPageChange(currentPage + 1)">
              Next
              <mat-icon>chevron_right</mat-icon>
            </button>
          </div>
        </mat-card>
      </section>
      <div *ngIf="isLoadingContributions" class="loading-container">
        <mat-spinner diameter="50"></mat-spinner>
        <p>Loading contributions...</p>
      </div>
    </div>
    <div *ngIf="!isLoading && currentView === 'ngos'" class="dashboard-view">
      <section class="hero-section">
        <div class="hero-content">
          <h1 class="hero-title">NGO Management</h1>
          <p class="hero-subtitle">Manage NGO accounts and verifications</p>
        </div>
      </section>
      <section class="filters-section">
        <mat-card class="filters-card">
          <div class="filters-grid">
            <mat-form-field appearance="outline">
              <mat-label>Search</mat-label>
              <input matInput type="text" placeholder="Search NGOs..." [(ngModel)]="searchTerm" (keyup.enter)="onSearch()">
            </mat-form-field>
            <mat-form-field appearance="outline">
              <mat-label>Status</mat-label>
              <select matNativeControl [(ngModel)]="filterBlocked" (change)="onSearch()">
                <option value="">All</option>
                <option value="false">Active</option>
                <option value="true">Blocked</option>
              </select>
            </mat-form-field>
            <button mat-raised-button color="primary" (click)="onSearch()">
              <mat-icon>search</mat-icon>
              Search
            </button>
          </div>
        </mat-card>
      </section>
      <section class="ngos-section">
        <mat-card class="table-card">
          <h2 class="section-title">NGOs List ({{ ngos.length }})</h2>
          <div class="table-wrapper">
            <table class="contributions-table">
      <thead>
        <tr>
          <th>NGO ID</th>
          <th>NGO Name</th>
          <th>Registration Number</th>
          <th>Contact Person</th>
          <th>Verification Status</th>
          <th>Created Date</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let ngo of ngos">
          <td><strong>{{ ngo.ngo_id || 'N/A' }}</strong></td>
          <td>{{ ngo.name }}</td>
          <td>{{ ngo.registrationNumber || 'N/A' }}</td>
          <td>{{ ngo.contactPersonName || ngo.contactInfo || 'N/A' }}</td>
          <td>
            <span [class]="getVerificationStatusClass(ngo.verificationStatus)">
              {{ getVerificationStatusText(ngo.verificationStatus) }}
            </span>
            <div *ngIf="ngo.verificationStatus === 'REJECTED' && ngo.rejectionReason" 
                 class="rejection-reason" 
                 [title]="ngo.rejectionReason">
              Reason: {{ ngo.rejectionReason }}
            </div>
          </td>
          <td>{{ ngo.createdAt | date:'short' }}</td>
          <td class="action-buttons">
            <div class="view-action">
              <button mat-raised-button color="accent" (click)="viewNgoDetails(ngo)" title="View NGO Details">
                <mat-icon>visibility</mat-icon>
                View
              </button>
            </div>
            <div class="verification-actions" *ngIf="ngo.verificationStatus === 'PENDING'">
                      <button mat-raised-button color="primary" (click)="approveNgo(ngo)" title="Approve NGO">
                        <mat-icon>check</mat-icon>
                        Approve
              </button>
                      <button mat-raised-button color="warn" (click)="rejectNgo(ngo)" title="Reject NGO">
                        <mat-icon>close</mat-icon>
                        Reject
              </button>
            </div>
            <div class="block-actions">
                      <button mat-raised-button 
                              [color]="ngo.isBlocked ? 'accent' : 'warn'"
                (click)="toggleBlockNgo(ngo)">
                {{ ngo.isBlocked ? 'Unblock' : 'Block' }}
              </button>
            </div>
          </td>
        </tr>
        <tr *ngIf="ngos.length === 0">
                  <td colspan="7" class="no-data">
                    <div class="no-data-content">
                      <mat-icon>business</mat-icon>
                      <p>No NGOs found</p>
                    </div>
                  </td>
        </tr>
      </tbody>
    </table>
          </div>
        </mat-card>
      </section>
    </div>
    <div *ngIf="!isLoading && currentView === 'email-templates'" class="dashboard-view">
      <section class="hero-section">
        <div class="hero-content">
          <h1 class="hero-title">Email Templates</h1>
          <p class="hero-subtitle">Manage email templates for system notifications</p>
        </div>
      </section>
      <mat-card class="template-selector-card" style="margin-bottom: 24px;">
        <mat-form-field appearance="outline" style="width: 100%;">
          <mat-label>Select Email Template</mat-label>
          <mat-select [(ngModel)]="selectedTemplateType" (selectionChange)="onTemplateTypeChange()">
            <mat-option *ngFor="let template of availableTemplateTypes" [value]="template.value">
              {{ template.label }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </mat-card>

      <div *ngIf="isLoadingTemplate" class="loading-container">
        <mat-spinner diameter="50"></mat-spinner>
        <p>Loading template...</p>
  </div>

      <div *ngIf="!isLoadingTemplate" class="template-view">
        <mat-card class="template-card">
          <div class="template-header">
            <h2 class="template-title">{{ getTemplateLabel() }} Email Template</h2>
            <div class="template-actions">
              <button *ngIf="!isEditingTemplate" mat-raised-button color="primary" (click)="startEditingTemplate()">
                <mat-icon>edit</mat-icon>
                Edit Template
              </button>
              <button *ngIf="!isEditingTemplate && !emailTemplate.isDefault" mat-stroked-button (click)="restoreDefaultTemplate()">
                <mat-icon>restore</mat-icon>
                Restore Default
            </button>
  </div>
</div>

          <div *ngIf="!isEditingTemplate" class="template-preview">
            <div class="template-info">
              <p><strong>Template Type:</strong> {{ emailTemplate.templateType }}</p>
              <p><strong>Status:</strong> {{ emailTemplate.isDefault ? 'Default Template' : 'Custom Template' }}</p>
            </div>
            <div class="template-content">
              <h3>Subject:</h3>
              <p class="template-subject">{{ emailTemplate.subject }}</p>
              
              <h3>Body Preview:</h3>
              <div class="template-body-preview" [innerHTML]="emailTemplate.bodyHtml"></div>
            </div>
          </div>

          <div *ngIf="isEditingTemplate" class="template-edit-form">
            <mat-form-field appearance="outline" class="full-width">
              <mat-label>Email Subject</mat-label>
              <input matInput [(ngModel)]="emailTemplate.subject" placeholder="Email subject line">
            </mat-form-field>

            <mat-form-field appearance="outline" class="full-width">
              <mat-label>Email Body (HTML)</mat-label>
              <textarea matInput [(ngModel)]="emailTemplate.bodyHtml" rows="20" placeholder="Email body HTML content"></textarea>
              <mat-hint>{{ getPlaceholderHint() }}</mat-hint>
            </mat-form-field>

            <div class="template-form-actions">
              <button mat-stroked-button (click)="cancelEditTemplate()">Cancel</button>
              <button mat-raised-button color="primary" (click)="saveEmailTemplate()">Save Template</button>
            </div>
          </div>
        </mat-card>
      </div>
    </div>
    <div *ngIf="!isLoading && currentView === 'leaderboard'" class="dashboard-view">
      <section class="hero-section">
        <div class="hero-content">
          <h1 class="hero-title">Leaderboard</h1>
          <p class="hero-subtitle">Top contributors and organizations making a difference</p>
        </div>
      </section>
      <app-leaderboard></app-leaderboard>
    </div>
    <div *ngIf="!isLoading && currentView === 'sliders'" class="dashboard-view">
      <section class="hero-section">
        <div class="hero-content">
          <h1 class="hero-title">Slider Management</h1>
          <p class="hero-subtitle">Manage hero section sliders for the home page</p>
        </div>
        <div class="hero-actions">
          <button mat-raised-button color="primary" (click)="openCreateSliderDialog()">
            <mat-icon>add</mat-icon>
            Create New Slider
          </button>
        </div>
      </section>
      <section class="sliders-section" *ngIf="!isLoadingSliders">
        <mat-card class="table-card">
          <h2 class="section-title">All Sliders ({{ sliders.length }})</h2>
          <div class="table-wrapper">
            <table class="contributions-table">
              <thead>
                <tr>
                  <th>Image</th>
                  <th>Title</th>
                  <th>Tagline</th>
                  <th>Order</th>
                  <th>Status</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let slider of sliders">
                  <td>
                    <img [src]="getSliderImageUrl(slider.image_url)" [alt]="slider.title" class="slider-thumbnail">
                  </td>
                  <td><strong>{{ slider.title }}</strong></td>
                  <td>{{ slider.tagline || 'N/A' }}</td>
                  <td>{{ slider.display_order }}</td>
                  <td>
                    <span [class]="slider.is_active ? 'status-active' : 'status-inactive'">
                      {{ slider.is_active ? 'Active' : 'Inactive' }}
                    </span>
                  </td>
                  <td class="action-buttons">
                    <button mat-raised-button color="accent" (click)="editSlider(slider)" title="Edit Slider">
                      <mat-icon>edit</mat-icon>
                      Edit
                    </button>
                    <button mat-raised-button [color]="slider.is_active ? 'warn' : 'primary'" (click)="toggleSliderStatus(slider)" title="Toggle Status">
                      <mat-icon>{{ slider.is_active ? 'visibility_off' : 'visibility' }}</mat-icon>
                      {{ slider.is_active ? 'Deactivate' : 'Activate' }}
                    </button>
                    <button mat-raised-button color="warn" (click)="deleteSlider(slider)" title="Delete Slider">
                      <mat-icon>delete</mat-icon>
                      Delete
                    </button>
                  </td>
                </tr>
                <tr *ngIf="sliders.length === 0">
                  <td colspan="6" class="no-data">
                    <div class="no-data-content">
                      <mat-icon>slideshow</mat-icon>
                      <p>No sliders found</p>
                      <p class="no-data-subtitle">Create your first slider to get started</p>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </mat-card>
      </section>

      <div *ngIf="isLoadingSliders" class="loading-container">
        <mat-spinner diameter="50"></mat-spinner>
        <p>Loading sliders...</p>
      </div>
    </div>
  </main>
</div>

<app-header></app-header>

<div class="donation-list-container">
  <header class="page-header">
    <div class="header-content">
      <h1>Available Donation Requests</h1>
      <p>Browse and contribute to donation requests from verified NGOs</p>
    </div>
  </header>
  <div class="filters-section">
    <div class="filters-card">
      <h3>Filter Donation Requests</h3>
      <div class="filters-grid">
        <div class="filter-group">
          <label>Category</label>
          <select [(ngModel)]="filterCategory" (change)="applyFilters()">
            <option value="">All Categories</option>
            <option value="FOOD">Food</option>
            <option value="FUNDS">Funds</option>
            <option value="CLOTHES">Clothes</option>
            <option value="MEDICINE">Medicine</option>
            <option value="BOOKS">Books</option>
            <option value="TOYS">Toys</option>
            <option value="OTHER">Other</option>
          </select>
        </div>
        <div class="filter-group">
          <label>Location</label>
          <input type="text" [(ngModel)]="filterLocation" placeholder="Search location..." (keyup.enter)="applyFilters()">
        </div>
        <div class="filter-actions">
          <button class="btn-primary" (click)="applyFilters()">Apply Filters</button>
          <button class="btn-outline" (click)="clearFilters()">Clear</button>
        </div>
      </div>
    </div>
  </div>
  <div *ngIf="errorMessage" class="error-message">
    <span>‚ö†Ô∏è</span>
    <span>{{ errorMessage }}</span>
  </div>
  <div *ngIf="isLoading" class="loading-state">
    <div class="spinner"></div>
    <p>Loading donation requests...</p>
  </div>
  <div *ngIf="!isLoading && donations.length > 0" class="donations-grid">
    <div class="donation-card" *ngFor="let donation of donations">
      <div class="donation-badge" [class.active]="donation.status === 'ACTIVE'">
        {{ donation.status || 'ACTIVE' }}
      </div>
      
      <div class="donation-header">
        <h3>{{ donation.donation_type || 'Donation Request' }}</h3>
        <span class="donation-category">{{ donation.donation_type }}</span>
      </div>

      <p class="donation-description">{{ donation.description || 'Help make a difference' }}</p>

      <div class="donation-details">
        <div class="detail-item" *ngIf="donation.ngo_name">
          <span class="detail-label">üè¢ NGO Name:</span>
          <span class="detail-value">{{ donation.ngo_name }}</span>
        </div>
        <div class="detail-item" *ngIf="donation.ngo_address">
          <span class="detail-label">üìç NGO Address:</span>
          <span class="detail-value">{{ donation.ngo_address }}</span>
        </div>
        <div class="detail-item">
          <span class="detail-label">üì¶ Donation Type:</span>
          <span class="detail-value">{{ donation.donation_type || 'N/A' }}</span>
        </div>
        <div class="detail-item">
          <span class="detail-label">üìä {{ getQuantityOrAmountLabel(donation.donation_type) }}:</span>
          <span class="detail-value">{{ formatQuantityOrAmount(donation) }}</span>
        </div>
        <div class="detail-item" *ngIf="donation.created_at">
          <span class="detail-label">üìÖ Posted On:</span>
          <span class="detail-value">{{ formatDate(donation.created_at) }}</span>
        </div>
      </div>

      <div class="donation-actions">
        <button class="btn-primary btn-full" (click)="contribute(donation.id)">
          Donate
        </button>
      </div>
    </div>
  </div>
  <div *ngIf="!isLoading && donations.length === 0" class="empty-state">
    <div class="empty-icon">üì¶</div>
    <h3>No donation requests found</h3>
    <p>Try adjusting your filters or check back later for new donation requests.</p>
  </div>
</div>
